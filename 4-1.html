<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>歐大選擇權教室 - Delta 方向敏感度教學</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM (使用穩定版本) -->
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <!-- React-Is (Recharts 依賴項) -->
    <script src="https://cdn.jsdelivr.net/npm/react-is@18.2.0/umd/react-is.production.min.js"></script>
    <!-- Prop-Types -->
    <script src="https://cdn.jsdelivr.net/npm/prop-types@15.8.1/prop-types.min.js"></script>
    <!-- Recharts (使用穩定的 UMD 版本) -->
    <script src="https://cdn.jsdelivr.net/npm/recharts@2.10.3/umd/Recharts.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        
        /* 修正滑桿在手機上的樣式 */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #fbbf24;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        // 顯式宣告從 Recharts 全域變數中提取組件
        const { 
            ResponsiveContainer, 
            AreaChart, 
            Area, 
            XAxis, 
            YAxis, 
            CartesianGrid, 
            Tooltip, 
            ReferenceLine 
        } = window.Recharts;

        const { useState, useMemo } = React;

        // SVG 圖標組件
        const TrendingUp = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>
        );
        const ShieldCheck = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><path d="m9 12 2 2 4-4"></path></svg>
        );
        const Zap = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
        );
        const MousePointer2 = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M7.3 13H11l4.5 9 2.5-1.5L13.5 12H17L5 2z"></path></svg>
        );

        const App = () => {
            const [underlyingPrice, setUnderlyingPrice] = useState(100);
            const [strikePrice] = useState(100);
            const [optionType, setOptionType] = useState('call');
            
            const BRAND_NAME = "歐大選擇權教室";
            const ALT_BRAND = "Joption";
            const IP_TAG = "IP: 歐大選擇權教室";

            // 邏輯運算：模擬 Delta 曲線
            const calculateDelta = (price, strike, type) => {
                const diff = price - strike;
                const sensitivity = 0.05;
                let d = 0;
                if (type === 'call') {
                    d = 1 / (1 + Math.exp(-sensitivity * diff));
                } else {
                    d = -1 / (1 + Math.exp(sensitivity * diff));
                }
                return parseFloat(d.toFixed(2));
            };

            const currentDelta = useMemo(() => calculateDelta(underlyingPrice, strikePrice, optionType), [underlyingPrice, optionType]);

            const chartData = useMemo(() => {
                const data = [];
                for (let p = strikePrice - 40; p <= strikePrice + 40; p += 2) {
                    data.push({
                        price: p,
                        delta: calculateDelta(p, strikePrice, optionType)
                    });
                }
                return data;
            }, [optionType]);

            return (
                <div className="min-h-screen pb-20">
                    <header className="bg-gradient-to-r from-blue-700 to-indigo-800 text-white p-6 sticky top-0 z-50 shadow-lg">
                        <div className="max-w-4xl mx-auto flex justify-between items-center">
                            <div>
                                <span className="bg-yellow-400 text-blue-900 text-xs font-bold px-2 py-1 rounded-full mb-1 inline-block">
                                    {IP_TAG}
                                </span>
                                <h1 className="text-2xl md:text-3xl font-bold">{BRAND_NAME}</h1>
                            </div>
                            <div className="text-right hidden sm:block text-blue-100 text-sm italic font-bold">
                                JOPTION ACADEMY
                            </div>
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto p-4 md:p-8 space-y-12">
                        {/* 介紹區塊 */}
                        <section className="bg-white rounded-3xl p-6 md:p-8 shadow-sm border border-slate-100">
                            <div className="flex items-center gap-3 mb-4">
                                <div className="bg-blue-100 p-2 rounded-lg text-blue-600">
                                    <TrendingUp />
                                </div>
                                <h2 className="text-2xl font-bold">什麼是 Delta？方向敏感度</h2>
                            </div>
                            <p className="text-slate-600 leading-relaxed mb-4 text-lg">
                                在 <span className="font-bold text-blue-600">{ALT_BRAND}</span> 的課程中，Delta 是最重要的風險指標。
                                代表：<span className="bg-yellow-100 px-1 font-semibold">標的價格每變動 1 點，選擇權權利金會跟著變動多少？</span>
                            </p>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                                <div className="bg-blue-50 p-4 rounded-2xl border border-blue-100">
                                    <h3 className="font-bold text-blue-800 mb-2 flex items-center gap-2"><ShieldCheck /> Call 的 Delta (正值)</h3>
                                    <p className="text-sm text-slate-700">與標的價格「同向」變動。數值介於 0 到 1。</p>
                                </div>
                                <div className="bg-red-50 p-4 rounded-2xl border border-red-100">
                                    <h3 className="font-bold text-red-800 mb-2 flex items-center gap-2"><ShieldCheck /> Put 的 Delta (負值)</h3>
                                    <p className="text-sm text-slate-700">與標的價格「反向」變動。數值介於 0 到 -1。</p>
                                </div>
                            </div>
                        </section>

                        {/* 互動模擬區塊 */}
                        <section className="bg-slate-900 rounded-3xl p-6 md:p-8 text-white shadow-2xl relative overflow-hidden">
                            <div className="relative z-10">
                                <h2 className="text-2xl font-bold mb-6 flex items-center gap-2 text-yellow-400">
                                    <MousePointer2 /> 互動模擬器：觀察 Delta 變化
                                </h2>
                                
                                <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                    <div className="space-y-6">
                                        <div className="bg-slate-800 p-4 rounded-xl border border-slate-700">
                                            <label className="block text-sm font-medium mb-3">選擇類型</label>
                                            <div className="flex bg-slate-700 p-1 rounded-lg">
                                                <button onClick={() => setOptionType('call')} className={`flex-1 py-2 rounded-md transition-all ${optionType === 'call' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-400 hover:text-white'}`}>Call</button>
                                                <button onClick={() => setOptionType('put')} className={`flex-1 py-2 rounded-md transition-all ${optionType === 'put' ? 'bg-red-600 text-white shadow-lg' : 'text-slate-400 hover:text-white'}`}>Put</button>
                                            </div>
                                        </div>

                                        <div className="bg-slate-800 p-4 rounded-xl border border-slate-700">
                                            <div className="flex justify-between mb-2">
                                                <label className="text-sm font-medium text-slate-300">調整標的價格</label>
                                                <span className="text-yellow-400 font-mono font-bold text-lg">{underlyingPrice}</span>
                                            </div>
                                            <input type="range" min="60" max="140" value={underlyingPrice} onChange={(e) => setUnderlyingPrice(Number(e.target.value))} className="w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer" />
                                            <div className="flex justify-between text-[10px] text-slate-500 mt-2">
                                                <span>{optionType === 'call' ? '價外 (OTM)' : '價內 (ITM)'}</span>
                                                <span>平值 (ATM)</span>
                                                <span>{optionType === 'call' ? '價內 (ITM)' : '價外 (OTM)'}</span>
                                            </div>
                                        </div>

                                        <div className="bg-blue-900/40 border border-blue-500/30 p-5 rounded-2xl text-center">
                                            <p className="text-xs text-blue-300 uppercase tracking-widest mb-1 font-semibold">當前 Delta</p>
                                            <p className={`text-5xl font-black mb-1 ${optionType === 'call' ? 'text-blue-400' : 'text-red-400'}`}>{currentDelta}</p>
                                            <p className="text-[10px] text-slate-400 mt-2 italic">這代表標的漲 1 點，部位賺/賠 {Math.abs(currentDelta)} 點</p>
                                        </div>
                                    </div>

                                    <div className="lg:col-span-2 h-[350px] bg-slate-800/50 rounded-2xl p-4 border border-slate-700 shadow-inner">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <AreaChart data={chartData} margin={{ top: 60, right: 15, left: -10, bottom: 20 }}>
                                                <defs>
                                                    <linearGradient id="colorDelta" x1="0" y1="0" x2="0" y2="1">
                                                        <stop offset="5%" stopColor={optionType === 'call' ? "#3b82f6" : "#ef4444"} stopOpacity={0.3}/>
                                                        <stop offset="95%" stopColor={optionType === 'call' ? "#3b82f6" : "#ef4444"} stopOpacity={0}/>
                                                    </linearGradient>
                                                </defs>
                                                <CartesianGrid strokeDasharray="3 3" stroke="#334155" vertical={false} />
                                                <XAxis dataKey="price" stroke="#64748b" fontSize={11} label={{ value: '標的價格', position: 'insideBottom', offset: -10, fill: '#64748b', fontSize: 12 }} />
                                                <YAxis stroke="#64748b" fontSize={11} domain={optionType === 'call' ? [0, 1] : [-1, 0]} />
                                                <Tooltip contentStyle={{ backgroundColor: '#1e293b', border: 'none', borderRadius: '12px', color: '#fff' }} />
                                                <ReferenceLine 
                                                    x={underlyingPrice} 
                                                    stroke="#fbbf24" 
                                                    strokeWidth={2} 
                                                    label={{ 
                                                        position: 'top', 
                                                        value: '您在這裡', 
                                                        fill: '#fbbf24', 
                                                        fontSize: 14, 
                                                        fontWeight: 'bold', 
                                                        offset: 25 
                                                    }} 
                                                />
                                                <Area type="monotone" dataKey="delta" stroke={optionType === 'call' ? "#3b82f6" : "#ef4444"} strokeWidth={3} fill="url(#colorDelta)" isAnimationActive={false} />
                                            </AreaChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-100">
                                <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><Zap className="text-yellow-500" /> Delta 在 {ALT_BRAND} 的兩大功用</h3>
                                <div className="space-y-4">
                                    <div className="flex gap-4 text-sm text-slate-600">
                                        <div className="bg-indigo-100 text-indigo-600 w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 font-bold">1</div>
                                        <p><strong>機率估算：</strong> 專業交易員常用 Delta 絕對值來估計該合約在到期時「處於價內」的機率。</p>
                                    </div>
                                    <div className="flex gap-4 text-sm text-slate-600">
                                        <div className="bg-indigo-100 text-indigo-600 w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 font-bold">2</div>
                                        <p><strong>部位對沖：</strong> 透過 Delta 數值，我們可以精確知道需要多少口期貨來沖銷目前的價格風險。</p>
                                    </div>
                                </div>
                            </section>

                            <section className="bg-white p-6 rounded-3xl shadow-sm border border-slate-100">
                                <h3 className="text-xl font-bold mb-4">Delta 速查表</h3>
                                <div className="text-xs overflow-x-auto">
                                    <table className="w-full">
                                        <thead className="bg-slate-50 text-slate-500 text-left">
                                            <tr><th className="p-2">狀態</th><th className="p-2">Call Delta</th><th className="p-2">Put Delta</th></tr>
                                        </thead>
                                        <tbody className="divide-y divide-slate-100">
                                            <tr><td className="p-2 font-bold text-blue-600">深價內</td><td className="p-2">趨近 1.00</td><td className="p-2">趨近 -1.00</td></tr>
                                            <tr><td className="p-2 font-bold text-purple-600">平值 (ATM)</td><td className="p-2">約 0.50</td><td className="p-2">約 -0.50</td></tr>
                                            <tr><td className="p-2 font-bold text-slate-400">深價外</td><td className="p-2">趨近 0.00</td><td className="p-2">趨近 0.00</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </section>
                        </div>

                        <section className="bg-blue-600 text-white p-8 rounded-3xl text-center shadow-xl border-b-4 border-blue-800">
                            <h2 className="text-2xl font-bold mb-4">歐大課後筆記</h2>
                            <p className="max-w-2xl mx-auto opacity-90 text-sm leading-relaxed mb-6">
                                記住，Delta 是會隨著標的價格變動而改變的動態數值。在 <strong>{ALT_BRAND}</strong> 實戰中，我們必須同時關注 <strong>Gamma</strong>，因為它決定了 Delta 變動的速度。
                            </p>
                            <div className="flex justify-center gap-4 text-xs font-bold uppercase tracking-widest">
                                <span className="bg-white/20 px-3 py-1 rounded-full">方向感</span>
                                <span className="bg-white/20 px-3 py-1 rounded-full">機率論</span>
                                <span className="bg-white/20 px-3 py-1 rounded-full">歐大精選</span>
                            </div>
                        </section>
                    </main>

                    <footer className="text-center text-slate-500 p-10 space-y-2 border-t border-slate-200 mt-10">
                        <div className="font-bold text-slate-700 tracking-widest text-base">
                            JOPTION | 歐大選擇權教室
                        </div>
                        <div className="text-xs md:text-sm">
                            © 2026 Joption Academy - 金融教育僅供參考，投資有風險，操作需謹慎
                        </div>
                        <div className="pt-2 opacity-50 font-mono text-[10px] tracking-tighter">
                            {IP_TAG}
                        </div>
                    </footer>
                </div>
            );
        };

        // 確保在 React 18 下正確啟動
        const rootElement = document.getElementById('root');
        const root = ReactDOM.createRoot(rootElement);
        root.render(<App />);
    </script>
</body>
</html>